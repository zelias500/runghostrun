<ion-view view-title="Welcome, {{ user.email }}!">
  <ion-content class="padding">

    <div class="list card">
      <div class="item item-divider">
        <div id="recent-select" class="tmk-tab-select" ng-class="recentTab" ng-click="toggle(true)">Your Recent Ghosts</div>
        <div id="friend-select" class="tmk-tab-select" ng-class="friendTab" ng-click="toggle(false)">Friend Activity</div>
      </div>

      <div class="item item-body" ng-if="!!recentTab">
        <p ng-show="{{recentRuns.length === 0}}">You have no recent run data. Let's go for a run!</p>
        <ion-list>
          <ion-item ng-repeat='run in recentRuns'>

            <!-- If ghost has not been deleted -->
            <div ng-if="run.ghost">
              <div class="item-text-wrap" ng-if="run.ghost.owner._id==user._id">
                You ran your own challenge {{run.ghost.title}} on {{timeStampToReadable(run.timestamp)}}
              </div>
              <div class="item-text-wrap" ng-if="run.ghost.owner._id!=user._id">
                You ran {{userName(run.ghost.owner)}}'s challenge {{run.ghost.title}} on {{timeStampToReadable(run.timestamp)}}
              </div>
            </div>
            <!-- If ghost has been deleted -->
            <div class="item-text-wrap" ng-if="!run.ghost">
              You ran against a ghost that has since been deleted.
            </div>
            <!-- Google map and run data -->
            <run-map ghost='run' clickable='false'></run-map>
            <run-stats data='run'></ghost-stats>

          </ion-item>
        </ion-list>
      </div>

      <div class="item item-body" ng-if="!!friendTab">
        <p ng-show="{{friendRuns.length === 0}}">No recent friend activity. Go make friends!</p>
        <ion-list>
          <ion-item ng-repeat='friendRun in friendRuns'>
          
            <!-- If ghost has not been deleted -->
            <div ng-if="friendRun.ghost">
              <div class="item-text-wrap" ng-if="friendRun.ghost.owner==friendRun.runner._id">
                {{userName(friendRun.runner)}} ran their own challenge
                {{friendRun.ghost.title}} on
                {{timeStampToReadable(friendRun.timestamp)}}
              </div>
              <div class="item-text-wrap" ng-if="friendRun.ghost.owner==user._id">
                {{userName(friendRun.runner)}} ran your challenge
                {{friendRun.ghost.title}} on
                {{timeStampToReadable(friendRun.timestamp)}}
              </div>
              <div class="item-text-wrap" ng-if="friendRun.ghost.owner!=friendRun.runner._id && friendRun.ghost.owner!=user._id">
                {{userName(friendRun.runner)}} ran
                {{friendRun.ghost.owner}}'s challenge
                {{friendRun.ghost.title}} on
                {{timeStampToReadable(friendRun.timestamp)}}
              </div>
            </div>
            <!-- If ghost has been deleted -->
            <div class="item-text-wrap" ng-if="!friendRun.ghost">
              You ran against a ghost that has since been deleted.
            </div>
            <!-- Google map and run data -->
            <run-map ghost='friendRun' clickable='true'></run-map>
            <run-stats data='friendRun'></ghost-stats>

          </ion-item>
        </ion-list>
      </div>

    </div>
  </ion-content>
</ion-view>
